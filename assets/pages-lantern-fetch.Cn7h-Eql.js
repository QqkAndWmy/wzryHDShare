import{a as t,r as a,s as e,h as n,u as s,b as i,c,w as l,i as o,o as r,d,n as h,e as u,l as f,m,F as b,p as v,t as k,v as _,g as L,q as C}from"./index-CfD7BLiY.js";import{F as y}from"./FloatingCustomerService.BHZgwF36.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T="http://cardKey.xkamy.xin:9876/api";const g=p({components:{FloatingCustomerService:y},data:()=>({activeTab:"È´òÁ∫ß",lanternList:[],showModal:!1,currentLantern:{},customImage:"https://i.ibb.co/S7rcGY7D/image.jpg",customText:"\nÂæÆ‰ø°: xkamy_xin\n ÂÖ¨‰ºóÂè∑: Â∞èÂáØÁà±ÁºñÁ®ã\nÈ∫ªÁÉ¶ÂêÑ‰ΩçÂÖ≥Ê≥®‰∏Ä‰∏ãÂÖ¨‰ºóÂè∑,Ë∞¢Ë∞¢üôè\nÊó†ËÆ∫ÊâìËµèÊúâÂê¶,ÈÉΩË∞¢Ë∞¢ÊÇ®ÁöÑÁÇπÂáª",buttonIcon:"‚ù§Ô∏è",title:"ÊâìËµèÂ∞èÂáØ(ÂæÆ‰ø°)"}),onLoad(){this.fetchData(this.activeTab)},methods:{switchTab(t){this.activeTab!==t&&(this.activeTab=t,this.fetchData(t))},async fetchData(s){t({title:"Âä†ËΩΩ‰∏≠..."});try{const t=(await a({url:`${T}/riverLantern/fetch`,method:"POST",data:{level:s}})).data;"success"===t.status?this.lanternList=t.data||[]:(e({title:t.info||"Ëé∑ÂèñÊï∞ÊçÆÂ§±Ë¥•",icon:"none"}),this.lanternList=[])}catch(i){console.error("Ëé∑ÂèñÊï∞ÊçÆËØ∑Ê±ÇÂ§±Ë¥•:",i),e({title:"ÁΩëÁªúÈîôËØØÊàñËØ∑Ê±ÇÂ§±Ë¥•",icon:"none"}),this.lanternList=[]}finally{n()}},refreshData(){this.fetchData(this.activeTab)},showLanternDetail(t){this.currentLantern=t,this.showModal=!0},hideModal(){this.showModal=!1},copyContent(){s({data:this.currentLantern.content,success:()=>{e({title:"Â§çÂà∂ÊàêÂäü",icon:"success"})},fail:()=>{e({title:"Â§çÂà∂Â§±Ë¥•",icon:"none"})}})},async markAsInvalid(){if(this.currentLantern.id)try{const t=(await a({url:`${T}/riverLantern/invalidate`,method:"POST",data:{id:this.currentLantern.id}})).data;"success"===t.status?(e({title:t.data||"Â∑≤Ê†áËÆ∞‰∏∫Êó†Êïà",icon:"success"}),this.lanternList=this.lanternList.filter((t=>t.id!==this.currentLantern.id))):e({title:t.info||"Ê†áËÆ∞Â§±Ë¥•",icon:"none"})}catch(t){console.error("Ê†áËÆ∞Êó†ÊïàËØ∑Ê±ÇÂ§±Ë¥•:",t),e({title:"ÁΩëÁªúÈîôËØØÊàñËØ∑Ê±ÇÂ§±Ë¥•",icon:"none"})}finally{this.hideModal()}else e({title:"Êï∞ÊçÆÈîôËØØ",icon:"none"})},async markAsUsed(){if(this.currentLantern.id)try{const t=(await a({url:`${T}/riverLantern/incrementUsage`,method:"POST",data:{id:this.currentLantern.id}})).data;"success"===t.status?(this.refreshData(),e({title:t.data||"‰ΩøÁî®ÈáèÂ∑≤Â¢ûÂä†",icon:"success"})):e({title:t.info||"Êõ¥Êñ∞Â§±Ë¥•",icon:"none"})}catch(t){console.error("Â¢ûÂä†‰ΩøÁî®ÈáèËØ∑Ê±ÇÂ§±Ë¥•:",t),e({title:"ÁΩëÁªúÈîôËØØÊàñËØ∑Ê±ÇÂ§±Ë¥•",icon:"none"})}finally{this.hideModal()}else e({title:"Êï∞ÊçÆÈîôËØØ",icon:"none"})}}},[["render",function(t,a,e,n,s,y){const p=L,T=o,g=C,x=i("FloatingCustomerService");return r(),c(T,{class:"container"},{default:l((()=>[d(T,{class:"tabs"},{default:l((()=>[d(p,{class:h(["tab-btn",{active:"‰∏≠Á∫ß"===s.activeTab}]),onClick:a[0]||(a[0]=t=>y.switchTab("‰∏≠Á∫ß"))},{default:l((()=>[u(" ‰∏≠Á∫ß ")])),_:1},8,["class"]),d(p,{class:h(["tab-btn",{active:"È´òÁ∫ß"===s.activeTab}]),onClick:a[1]||(a[1]=t=>y.switchTab("È´òÁ∫ß"))},{default:l((()=>[u(" È´òÁ∫ß ")])),_:1},8,["class"])])),_:1}),d(T,{class:"refresh-section"},{default:l((()=>[d(p,{class:"refresh-btn",onClick:y.refreshData},{default:l((()=>[u("Âà∑Êñ∞Êï∞ÊçÆ")])),_:1},8,["onClick"])])),_:1}),d(T,{class:"list-section"},{default:l((()=>[(r(!0),f(b,null,m(s.lanternList,((t,a)=>(r(),c(T,{key:t.id,class:"lantern-item",onClick:a=>y.showLanternDetail(t)},{default:l((()=>[d(g,{class:"lantern-text"},{default:l((()=>[u(k(t.content),1)])),_:2},1024),d(g,{class:"lantern-meta"},{default:l((()=>[u("‰ΩøÁî®: "+k(t.usageCount)+" Ê¨°",1)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0===s.lanternList.length?(r(),c(T,{key:0,class:"empty-text"},{default:l((()=>[u(" ÊöÇÊó†Êï∞ÊçÆ ")])),_:1})):v("",!0)])),_:1}),s.showModal?(r(),c(T,{key:0,class:"modal-overlay",onClick:y.hideModal},{default:l((()=>[d(T,{class:"modal-content",onClick:a[2]||(a[2]=_((()=>{}),["stop"]))},{default:l((()=>[d(g,{class:"modal-text"},{default:l((()=>[u(k(s.currentLantern.content),1)])),_:1}),d(T,{class:"modal-actions"},{default:l((()=>[d(p,{class:"modal-btn copy-btn",onClick:y.copyContent},{default:l((()=>[u("ÁÇπÂáªÂ§çÂà∂")])),_:1},8,["onClick"]),d(p,{class:"modal-btn invalid-btn",onClick:y.markAsInvalid},{default:l((()=>[u("‰∏çËÉΩ‰ΩøÁî®")])),_:1},8,["onClick"]),d(p,{class:"modal-btn valid-btn",onClick:y.markAsUsed},{default:l((()=>[u("ÂèØ‰ª•‰ΩøÁî®")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):v("",!0),d(x,{imagePath:s.customImage,title:s.title,"text-content":s.customText,buttonIcon:s.buttonIcon},null,8,["imagePath","title","text-content","buttonIcon"])])),_:1})}],["__scopeId","data-v-6eecdf0b"]]);export{g as default};
